pipeline {
    agent {
        label 'centos'
    }
    stages {
        stage('clean') {
            steps {
                cleanWs()
            }
        }
        // stage('git') {
        //     steps {
        //         git credentialsId: '09839795-e2da-4765-b6b7-9741b360b426', url: 'git@github.com:biker11rus/kibana-role.git'
        //     }
        }
        stage('requirements') {
            steps{
               sh "pip3 install -r tox-requirements.txt" 
               sh "ansible-galaxy collection install community.docker"
               sh "ansible-galaxy collection install community.general"
            }
        }
        stage('molecule'){
            steps{
                sh "molecule test"
            }
        }
    }
}
